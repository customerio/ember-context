{"version":3,"file":"utils-b476cb2e.js","sources":["../src/-private/utils.ts"],"sourcesContent":["import type ContextRegistry from '../context-registry';\nimport {\n  dependencySatisfies,\n  importSync,\n  macroCondition,\n} from '@embroider/macros';\nimport type Owner from '@ember/owner';\n\nlet getOwner: (context: unknown) => Owner | undefined;\n\nif (macroCondition(dependencySatisfies('ember-source', '>=4.10.0'))) {\n  getOwner = (importSync('@ember/owner') as any).getOwner;\n} else {\n  getOwner = (importSync('@ember/application') as any).getOwner;\n}\n\n// TODO: See if we can type the owner\nexport function getProvider(owner: any, contextKey: keyof ContextRegistry) {\n  const renderer = getOwner(owner)?.lookup('renderer:-dom') as any;\n\n  if (renderer == null) {\n    return null;\n  }\n\n  const provideConsumeContextContainer =\n    renderer._runtime?.env?.provideConsumeContextContainer;\n\n  if (provideConsumeContextContainer == null) {\n    return null;\n  }\n\n  const contextsObject = provideConsumeContextContainer.contextsFor(owner);\n  return contextsObject?.[contextKey];\n}\n\nexport function hasContext(owner: any, contextKey: keyof ContextRegistry) {\n  const provider = getProvider(owner, contextKey);\n  return provider != null;\n}\n\nexport function getContextValue<K extends keyof ContextRegistry>(\n  owner: any,\n  contextKey: K,\n): ContextRegistry[K] | undefined {\n  if (!hasContext(owner, contextKey)) {\n    return undefined;\n  }\n  const providerObj = getProvider(owner, contextKey);\n  return providerObj.instance[providerObj.key];\n}\n"],"names":["getOwner","macroCondition","dependencySatisfies","importSync","getProvider","owner","contextKey","renderer","lookup","provideConsumeContextContainer","_runtime","env","contextsObject","contextsFor","hasContext","provider","getContextValue","undefined","providerObj","instance","key"],"mappings":";;AAQA,IAAIA,QAAiD,CAAA;AAErD,IAAIC,cAAc,CAACC,mBAAmB,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC,EAAE;AACnEF,EAAAA,QAAQ,GAAIG,UAAU,CAAC,cAAc,CAAC,CAASH,QAAQ,CAAA;AACzD,CAAC,MAAM;AACLA,EAAAA,QAAQ,GAAIG,UAAU,CAAC,oBAAoB,CAAC,CAASH,QAAQ,CAAA;AAC/D,CAAA;;AAEA;AACO,SAASI,WAAWA,CAACC,KAAU,EAAEC,UAAiC,EAAE;EACzE,MAAMC,QAAQ,GAAGP,QAAQ,CAACK,KAAK,CAAC,EAAEG,MAAM,CAAC,eAAe,CAAQ,CAAA;EAEhE,IAAID,QAAQ,IAAI,IAAI,EAAE;AACpB,IAAA,OAAO,IAAI,CAAA;AACb,GAAA;EAEA,MAAME,8BAA8B,GAClCF,QAAQ,CAACG,QAAQ,EAAEC,GAAG,EAAEF,8BAA8B,CAAA;EAExD,IAAIA,8BAA8B,IAAI,IAAI,EAAE;AAC1C,IAAA,OAAO,IAAI,CAAA;AACb,GAAA;AAEA,EAAA,MAAMG,cAAc,GAAGH,8BAA8B,CAACI,WAAW,CAACR,KAAK,CAAC,CAAA;EACxE,OAAOO,cAAc,GAAGN,UAAU,CAAC,CAAA;AACrC,CAAA;AAEO,SAASQ,UAAUA,CAACT,KAAU,EAAEC,UAAiC,EAAE;AACxE,EAAA,MAAMS,QAAQ,GAAGX,WAAW,CAACC,KAAK,EAAEC,UAAU,CAAC,CAAA;EAC/C,OAAOS,QAAQ,IAAI,IAAI,CAAA;AACzB,CAAA;AAEO,SAASC,eAAeA,CAC7BX,KAAU,EACVC,UAAa,EACmB;AAChC,EAAA,IAAI,CAACQ,UAAU,CAACT,KAAK,EAAEC,UAAU,CAAC,EAAE;AAClC,IAAA,OAAOW,SAAS,CAAA;AAClB,GAAA;AACA,EAAA,MAAMC,WAAW,GAAGd,WAAW,CAACC,KAAK,EAAEC,UAAU,CAAC,CAAA;AAClD,EAAA,OAAOY,WAAW,CAACC,QAAQ,CAACD,WAAW,CAACE,GAAG,CAAC,CAAA;AAC9C;;;;"}